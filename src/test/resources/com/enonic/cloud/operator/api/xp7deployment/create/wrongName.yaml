admissionRequest:
  request:
    operation: CREATE
    object:
      apiVersion: enonic.cloud/v1alpha2
      kind: Xp7Deployment
      metadata:
        name: wrongname
        namespace: mycloud-mysolution-myenv-myservice2
        labels:
          cloud: mycloud
          solution: mysolution
          environment: myenv
          service: myservice
      spec:
        enabled: true
        xpVersion: 7.1.2
        nodesSharedDisks:
          - name: blobstore
            size: 1Gi
          - name: snapshots
            size: 1Gi
        nodeGroups:
          - name: main
            master: true
            data: true
            replicas: 1
            resources:
              cpu: "1"
              memory: 512Mi
              disks:
                - name: index
                  size: 200Mi

assertPatch:
  - op: add
    path: /status
    value:
      state: PENDING
      message: Created
      fields:
        pods: []

assertException: "Xp7Deployment name must be equal to <Cloud>-<Solution>-<Environment>-<Service> according to labels, i.e: 'mycloud-mysolution-myenv-myservice'"