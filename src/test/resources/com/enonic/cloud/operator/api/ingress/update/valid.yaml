admissionRequest:
  request:
    operation: UPDATE
    oldObject:
      apiVersion: networking.k8s.io/v1beta1
      kind: Ingress
      metadata:
        name: test-domain-purplejs-io
        namespace: mycloud-mysolution-myenv-myservice
        annotations:
          enonic.cloud/ingress.cert.manage: "true"
          enonic.cloud/xp7.vhost.mapping.1.host: test-domain.purplejs.io
          enonic.cloud/xp7.vhost.mapping.1.source: /
          enonic.cloud/xp7.vhost.mapping.1.target: /admin
          enonic.cloud/xp7.vhost.mapping.1.idproviders: system
      spec:
        rules:
          - host: test-domain.purplejs.io
            http:
              paths:
                - backend:
                    serviceName: master
                    servicePort: 8080
                  path: /
    object:
      apiVersion: networking.k8s.io/v1beta1
      kind: Ingress
      metadata:
        name: test-domain-purplejs-io
        namespace: mycloud-mysolution-myenv-myservice
        annotations:
          kubernetes.io/ingress.class: "myingress"
          enonic.cloud/xp7.vhost.mapping.1.host: test-domain.purplejs.io
          enonic.cloud/xp7.vhost.mapping.1.source: /
          enonic.cloud/xp7.vhost.mapping.1.target: /admin
          enonic.cloud/xp7.vhost.mapping.1.idproviders: system
      spec:
        rules:
          - host: test-domain.purplejs.io
            http:
              paths:
                - backend:
                    serviceName: master
                    servicePort: 8080
                  path: /

assertResult:
  apiVersion: networking.k8s.io/v1beta1
  kind: Ingress
  metadata:
    name: test-domain-purplejs-io
    namespace: mycloud-mysolution-myenv-myservice
    annotations:
      kubernetes.io/ingress.class: "myingress"
      enonic.cloud/xp7.vhost.mapping.1.host: test-domain.purplejs.io
      enonic.cloud/xp7.vhost.mapping.1.source: "/"
      enonic.cloud/xp7.vhost.mapping.1.target: "/admin"
      enonic.cloud/xp7.vhost.mapping.1.idproviders: "system"
  spec:
    rules:
      - host: test-domain.purplejs.io
        http:
          paths:
            - backend:
                serviceName: master
                servicePort: 8080
              path: /